<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Document</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/7.0.0/normalize.css" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.css" />
  <style>

  body {

    background: #fcfcfc;
    color: #111;

    width: 950px;
    margin: 0 auto;
  }

  h1 {
    padding: 40px 0;
    font-size: 1.0rem;
    text-align: center;
  }

  .parameters {
    padding: 10px 10px 10px 10px;
    text-align: center;
  }

  .parameters input {
    margin-right: 10px;
    font-size: 0.8rem;
    width: 50px;
  }

  .parameters form {
    padding-bottom: 20px;
  }

  .canvas {
    width: 600px;
    margin: 0 auto;
  }

  </style>

</head>
<body>

  <h1>Example3 Bayesian Desicion for Three-Dimentinoal Binary Data</h1>

  <div class="parameters">
    <form>
      <label for="p1">$P(\omega_1)$</label>
      <input type="number" id="p1" name="p1" placeholder="0.50" value="0.50" min="0.0" max="1.0" step="0.1">

      <label for="p">$p_i$</label>
      <input type="number" id="p" name="p" placeholder="0.80" value="0.80" min="0.0" max="1.0" step="0.1">

      <label for="q">$q_i$</label>
      <input type="number" id="q" name="q" placeholder="0.50" value="0.50" min="0.0" max="1.0" step="0.1">

      <input type="button" value="Set" onclick="changed()">

    </form>

    <p>$w_i$=<span id="wi"></span>, $w_0$=<span id="w0"></span></p>
    <p>$g(\boldsymbol{x})=\sum_{i=1}^3 w_i x_i + w_0 = 0$</p>
  </div>

  <div id="app" class="canvas"></div>

</body>

<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.2/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.21.0/vis.min.js"></script>
<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    },
    CommonHTML: { matchFontHeight: false }
  });
</script>
<script>

const container = document.getElementById('app')
const p1Val     = document.getElementById('p1')
const pVal      = document.getElementById('p')
const qVal      = document.getElementById('q')
const wiVal     = document.getElementById('wi')
const w0Val     = document.getElementById('w0')

const options = {
  width:  '600px',
  height: '500px',
  style: 'surface',
  showPerspective: true,
  showGrid: true,
  showShadow: false,
  keepAspectRatio: true,
  verticalRatio: 1.0,
  xMax: 1,
  xMin: 0,
  yMax: 1,
  yMin: 0,
  zMax: 1,
  zMin: 0,
  xStep: 0.2,
  yStep: 0.2,
  zStep: 0.2,
  xLabel: 'x',
  yLabel: 'y',
  zLabel: 'z',
  axisColor: '#111'
};

var data = new vis.DataSet();
data.add({id: 0, x: 0, y: 0, z: 0, style: 0})
var graph3d = new vis.Graph3d(container, data, options)

function changed() {

  draw(parseFloat(p1Val.value), 1.0 - parseFloat(p1Val.value), parseFloat(pVal.value), parseFloat(qVal.value))
  MathJax.Hub.Queue(["Typeset",MathJax.Hub])
}

function draw(p1, p2, p, q) {

  var w_i = Math.log((p * (1.0-q))/(q * (1.0-p)))
  var w_0 = Math.log((1.0-p)/(1.0-q)) * 3 + Math.log(p1/p2)

  alpha = w_0 / w_i

  w0.innerText = '$'+w_0.toFixed(3)+'$'
  wi.innerText = '$'+w_i.toFixed(3)+'$'

  console.log(p1, p2, p, q, w_i, w_0)

  x_list = Array.from(new Array(51)).map((v,i) => i * 0.02)
  y_list = Array.from(new Array(51)).map((v,i) => i * 0.02)

  var data = new vis.DataSet();

  var i = 0, j = 0

  var counter = 0
  y_list.forEach(function(y) {
    x_list.forEach(function(x) {
      z = -y - x - alpha
      // if (0 <= z && z <= 1) {
        data.add({id: counter++, x: x, y: y, z: z})
      // }
    })
  })

  if (data.length <= 0) {
    alert('cannot find possible z')
    return
  }

  graph3d.setData(data)
}

draw(0.5, 0.5, 0.8, 0.5)

</script>
</html>
